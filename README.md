# 商品登録入力ツール

Excel形式の商品データを効率的に管理・編集するためのPyQt5製デスクトップアプリケーションです。

## 主要機能

- **商品データ管理**: Excel形式での商品情報一括管理
- **SKU管理**: 商品バリエーション（サイズ、色など）の管理
- **楽天・Yahoo属性連携**: ECモール属性との自動同期
- **Excel風UI**: 直感的な表形式データ編集
- **検索・置換**: Excel風の高機能検索・置換機能
- **自動保存**: データ損失防止のための自動保存機能
- **自動更新**: アプリケーションの自動アップデート機能

## システム要件

- **OS**: Windows 10以降 / macOS 10.15以降 / Linux (Ubuntu 18.04以降)
- **Python**: 3.8 - 3.11
- **メモリ**: 4GB以上推奨
- **ディスク容量**: 5GB以上の空き容量推奨

## 依存関係

```
PyQt5 >= 5.15.0
openpyxl >= 3.0.0
psutil >= 5.8.0
requests >= 2.25.0
packaging >= 20.0
```

## インストール・実行方法

### 開発環境での実行

1. リポジトリのクローン:
```bash
git clone <repository-url>
cd 商品登録入力ツール
```

2. 依存パッケージのインストール:
```bash
pip install -r requirements.txt
```

3. アプリケーションの実行:
```bash
python product_app.py
```

### ビルド済み実行ファイルの使用

1. `build/` または `dist/` ディレクトリから実行ファイルを起動
2. 初回起動時にデータディレクトリが自動作成されます

## 基本的な使い方

1. **データファイルの読み込み**: メニューから Excel ファイルを選択
2. **商品編集**: 右側のフォームで商品情報を編集
3. **SKU管理**: 下部のテーブルでバリエーション管理
4. **検索**: Ctrl+F で検索パネルを開き、データを検索・置換
5. **保存**: Ctrl+S でデータを保存（自動保存も有効）

## ファイル構成

- `product_app.py`: メインアプリケーション
- `constants.py`: アプリケーション定数
- `models.py`: データモデル定義
- `widgets.py`: カスタムUI部品
- `loaders.py`: データ読み込み処理
- `utils.py`: ユーティリティ関数
- `src/utils/`: システム安定性・自動更新関連モジュール

## トラブルシューティング

### よくある問題

1. **起動エラー**: 依存パッケージが正しくインストールされているか確認
2. **データ読み込みエラー**: Excelファイルの形式・エンコーディングを確認
3. **保存エラー**: ディスク容量・書き込み権限を確認

### ログファイル

アプリケーションログは以下の場所に保存されます:
- Windows: `%APPDATA%/ProductAppUserData/logs/`
- macOS/Linux: `~/.local/share/ProductAppUserData/logs/`

## 開発者向け情報

### ビルド方法

```bash
# PyInstallerでの実行ファイル作成
pyinstaller --clean --noconfirm ProductRegisterTool.spec

# または手動リリース
python release.bat
```

### テスト実行

```bash
# 全テスト実行
python run_tests.py

# 特定タイプのテスト実行
python run_tests.py --unit    # 単体テストのみ
python run_tests.py --gui     # GUIテストのみ
python run_tests.py --cov     # カバレッジ付きテスト
```

### コード品質

- **明示的インポート**: ワイルドカードインポートを避け、明示的なインポートを使用
- **ログ出力**: `print()` ではなく `logging` モジュールを使用
- **エラーハンドリング**: 徹底したエラーハンドリングと万が一対策システム
- **テストカバレッジ**: pytest ベースのテストスイート
- **コードフォーマット**: PEP8 準拠の推奨

## ライセンス

本ソフトウェアの利用条件については、プロジェクト管理者にお問い合わせください。

## 更新履歴

- v2.6.x: 自動更新機能・検索機能強化
- v2.5.x: SKU管理機能改善
- v2.4.x: UI/UX改善・安定性向上
